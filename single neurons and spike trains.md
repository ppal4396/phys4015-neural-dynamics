# single neurons and spike trains

## Hodgkin-Huxley model of the action potential

Describes cell membrane potential as continuous dynamic system.

Components:
- cell membrane (capacitor)
- Voltage-gated Ion channels (nonlinear conductance)
- Leaky ion channels (linear conductance)
- Electrochemical gradients driving flows of ions (voltage sources)
- Ion exchangers (current sources)

Total current through membrane (in cell with Na and K channels):

$$ I = C_m \frac {dV_m} {dt} + g_K \cdot (V_m - V_K) + g_{Na} \cdot
( V_m - V_{Na} ) + g_l \cdot (V_m - V_l), $$
where
- $C_m$ is membrane capacitance
- $V_m$ is membrane potential
- $g_K$ and $g_{Na}$ are conductances of voltage-gated Potassium and Sodium channels
- $g_l$ is conductance of leaky channels
- $V_K$ , $V_{Na}$ and $V_l$ are reversal potentials due to respective channels.

Note 4 terms being added.
1. Current flowing through lipid bilayer.
2. Current through $K$ channels
3. Current through $Na$ channels
4. Current through leaky channels

Four coupled differential equations are used to describe varying cell membrane potential.
1. 
$$ I = C_m \frac {dV_m} {dt} + 
  \bar{g}_K n^4 (V_m - V_K) + 
  \bar{g}_{Na} m^3 h ( V_m - V_{Na} ) + 
  \bar{g}_l \cdot (V_m - V_l) $$
2. $$ \frac {dn} {dt} = \alpha_n (1 - n) - \beta_n n$$
3. $$\frac{dm}{dt} \alpha_m (1 - m) - \beta_m m$$
4. $$\frac{dh}{dt} \alpha_h (1 - h) - \beta_h h$$
where
- $\bar{g}$ is maximal conductance
- $n$ is a dimensionless probability in $[0, 1]$ of $K$ channel subunit activation
	- (raised to 4th power because four subunits that require activation)
-  $m$ is a dimensionless probability in $[0, 1]$ of $Na$ channel subunit activation
- $h$ is a dimensionless probability in $[0, 1]$ of $Na$ channel subunit inactivation.
- $\alpha$ is a rate constant, dependent on membrane potential. (steady state values depend on $V_m$)
$$ \alpha = \text{steady state value for activation}  / \tau$$
- $\beta$ is a rate constant, dependent on membrane potential.  
$$\beta = \text{steady state value for inactivation} / \tau $$
Note $\tau$ is a time constant for the relevant probability ($n$, $m$ or $h$).
Steady state values can be modelled differently (but always depends on $V_m$).

## leaky integrate-and-fire model of spike events

$$ \tau_m \frac{du}{dt} = - u(t) + RI(t) $$
where
- $\tau_m$ = membrane time constant
- $u$ = membrane potential
- $R$ = membrane resistance
- $I$ = driving current through membrane

Spikes are characterised by their firing time $$t^{(f)} : u(t^{(f)}) = u_{th}$$where $u_{th}$ is a firing threshold.
Immediately after $t^{(f)}$, the potential is reset, following
$$\lim_{t \to t^{(f)} \space ; \space t > t^{(f)}} 
u(t) = u_r$$
where $u_r$ is the resting potential.

Suppose a spike occurs at $t = t^{(1)}$, where $I(t) = I_0$. The membrane potential at a time after $t^{(1)}$ is given by

$$u(t) = RI_0 \bigl( 1 - \exp ( - \frac{t - t^{(1)}} {\tau_m}) \bigr) $$
From the above, we have a spike at a point in time, if $RI_0 > u_{th}$, and no spike otherwise.

We can find the time taken $T= t^{(2)} - t^{(1)}$ for the membrane potential to reset, and another spike to occur, as follows.

$$u_{th} = RI_0 \bigl( 1 - \exp ( - \frac{t^{(2)} - t^{(1)}} {\tau_m}) \bigr) $$
$$ T = \tau_m \ln\frac{RI_0}{RI_0 - u_{th}} $$
This shows the regular spike pattern/oscillatory activity generated by the leaky iaf model, with constant driving current.

## analysing spike trains (in single neurons)

**Observed spike trains are stochastic**

- without external stimulus, spike trains show high variability
- with external constant stimulus, there is still variability in resulting action potential sequence

### poisson point process

- models a stochastic time series
$$ P_T[n]: \text{probability that $n$ spikes occur in time interval $T$}$$
- using a bin model and making some assumptions we arrive at...
$$P_T(n) = \frac{(rT)^n}{n!}e^{(-rT)} $$
- where T is a time interval
- r is a firing rate
- n is the number of bins in this interval

However real neural spike trains show greater variability than expected from a poisson distribution.

### fano factor

Consider fano factor: ratio of variance to mean (of the number of spikes within a given time window).

For varying time window lengths, fano factor of poisson model is 1; however in experimental data, fano factor can increase to 100 for a window of 100 seconds. So for longer time windows, variability for the number of spikes occuring increases, beyond a Poisson model of stochasticity. 

Similar observation: in cortical neurons, counting number of spikes in varying interval lengths, we observe a long right-tailed distribution. i.e. spike count rate increases in longer time windows.

### inter-spike Interval

the intervals between consecutive spike events.
$$T_i = t_{i+1} - t_i $$

**Co-efficient of Variation**:
$$C_V=\frac{(Var(T_i))^{1/2}}{\langle T_i \rangle} $$
$C_V$ is 1 for Poisson process.

Experimentally, ISIs fall in right-skewed distributions.

### neural response function

Simple way to calculate total response to a stimulus. 

We have a set of spike times, after some stimulus. 
$$ S = \{t_1, t_2, \ldots , t_n \} $$
Total **neural response** in a time interval can then be represented by summing times since previous spikes. $\delta$ is dirac delta function (?) 
$$ \rho (t) = \sum_{i=1}^{n}\delta(t - t_i) $$
### spike count rate

**spike-count rate** counts the number of spikes in a time interval, divided by time interval. This is equivalent to average neural response?
$$r = \frac{n}{T} = \frac{1}{T}\int_0^{T}\rho(\tau)\,d\tau$$
### firing rate (or 'spike density')

Choose a time bin width. Count the number of spikes in each time bin, averaged across all trials
for this neuron. Divide each count by width of time bin. Now you have firing rate as a function of time.

**firing rate (averaged across trials)** 
$$r(t)=\frac{1}{\triangle t}\int_t^{t+\triangle t}\langle \rho(\tau)\rangle \, d\tau $$
### average firing rate (or 'population activity')

This is the firing rate, but, in each time bin (or, as written below, for one time window), you find average spike count across population, instead of across trials.

 **firing rate (averaged across population)**
$$\langle r \rangle= \frac{\langle n \rangle}{T} = \frac{1}{T}\int_0^{T}\langle\rho(\tau)\rangle\,d\tau = \frac{1}{T}\int_0^Tr(\tau) \, d\tau$$
### reverse correlation

This is a spike triggered average (average number of stimuli per spike within some time window e.g. 100 ms).

Has been shown that spike triggered average can be used for stimulus reconstruction, indicating fundamentally that time-varying input to a single neuron is indeed encoded by its spike times.



